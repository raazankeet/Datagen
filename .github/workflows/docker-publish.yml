name: build-specs
on: push
jobs:
  load_config:
    runs-on: ubuntu-latest
    outputs:
      dbversion: ${{ steps.load.outputs.version }}
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Load the configuration
        id: load
        run: |
          echo version=`cat pom.xml  |grep  '<version>.*</version>'|head -2 | tail -1 |sed 's/<version>\(.*\)<\/version>/\1/'|tr -d '[:space:]'` >> $GITHUB_OUTPUT

  build-and-deploy:
    runs-on: ubuntu-latest
    needs: load_config
    env:
      DBVERSION: ${{ needs.load_config.outputs.dbversion }}

    steps:
      - name: Checkout the specifications
        uses: actions/checkout@v3

      - name: What version is this?
        run: |
          echo DocBook version ${{ env.DBVERSION }}
